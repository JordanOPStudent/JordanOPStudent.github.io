---
layout: post
title: Week 13-16
---
#Week 13
During a day that I wasn't able to come to class, Alister demoed the server to Faisal. Faisal wasn't quite happy with every student having the same generic password. Which was an understandable concern but my thought was that it was a placeholder for the meantime while we tested things. Regardless, we both suggested changing it to the student ids as we knew that's the pretty obvious solution to all of this. He also wanted us to load test the server in case of a worst case scenario. He also wanted to ask if the machine IP was permenant which it was from the very start as when you shut down the server via Azure, you can ask it to reserve the IP address.

I also discussed with Alister about the new scripts I made but he was adament that they'd be more confusing than the current set up. So, I decided to scrap them and leave them on the server just in case.

Regardless, I let Alister sort out the student password issues while I went ahead and started work on the security server. The security server was essentially a replication server that Rob wants to make adjustments to as a test bed for changes to our current server. To make it was a bit more awkward than inteneded as I had to jump through a few hoops. I had to clone the disks then create a new OS from one of those disks. I decided upon using the same type of virtual machine as before but one tier down. With 1GB or RAM and 1 CPU, it was going to be a fairly simple server with pretty much the exact settings.

However once I created it, I noticed that I couldn't SSH into it via the administrator account that Rob wanted me to create. I believe this was something that Azure does as default as it edits the sshd_config file to match the same settings as the virtual machine. Considering that we made the server with a private key instead of a password, I simply logged in with the old admin account via a private key and changed the password authentication back on.

It took a bit longer than I intended to get things up and running, it even bled into the next week as I was a bit strapped for time. At first, the data disk for the security server corrupted so in a way I had never seen before. Thankfully, we just simply cloned the original disk back on and it was fine. But then there was issues with DNS. As I had to change the domain for the server to something new, for some strange reason, every time I tried to go onto the phpMyAdmin portal of the security server, it just redirected back to the original server. This was due to some old DNS records on my local machine that I had to clean out. But to also prevent this from happening in the future, I had Rob create a new name record for the server to live upon and changed everything on that server to point to the new address. There was some lingering DNS issues but I believe that is on my end rather than on the machines themselves.

#Week 14
This week I spent most of my time finishing up the security server and looking into perhaps creating a backup solution using Microsoft's Azure Storage Containers. The best way to describe them is they're Microsoft's answer to Amazon S3 buckets although I believe they're a bit more flexible. Regardless, there was a few issues I had to sort out. One, I've never used them before so I had to do a lot of research on the topic and to figure out how they worked. There was some issues with firewalls and how the containers were accessed but decided that as long as they were apart of the server's network, they'd be fine.

I decided that we needed a cold storage account that will be used to create containers. I had heard that the rest of the devops team are considering making a backup server but for now, this will serve as a temporary solution until that has been created. For now, I started work on the backup script and how we were going to transfer the data on.

Considering that containers aren't your normal, standard storage systems, we had to use a special program called `blobfuse` to mount it onto the Linux machine. Thankfully, Microsoft had documentation on such a task and it made mounting onto it a pretty simple task. Now I had to work out how to exactly backup it up on a routine and what that routine will consist of.

This was also the week I looked into migrating our automatic updates from the debian package to Azure. However, when I tried this I didn't have permissions so I asked Faisal if he could sort that problem out for me.

#Week 15
Talking to Rob, I tried to figure out a good backup solution and it seemed like the idea I had in mind was exactly how the current server was used. So I went ahead and started my work on creating the scripts. At first I tried to use mysqldumps to simply dump the entire sql file onto the container but then decided that it'd be inefficent and landed on using mariabackup instead as that allowed us to have incremental backups as well as full backups. My solution was simple; create a full backup at the start of every month, upload that to the storage container then every night there will be an incremental backup to keep track of everything. I did think about perhaps changing it to weekly but for now, I've left it as monthly. I did try to figure out the best way to make the script run on a rountine but simply settled on the easiest solution by using a crontab. I am a bit concerned that the OS disk won't have enough space for storing all of these incremental backups but we were running out of time.

Now that Faisal has created an automation service and given me permissions for it, I was able to easily set up the update schedule quite easily. It was simply turning it on and setting up the appropiate schedule. I decided upon having security updates performed nightly and have regular updates on Sunday morning along with reboots. This will make sure that the patches are applied fully and everything will be kept up to date, lowering the vulnerability of the server.

#Week 16
Unfortunately, I was sick over the weekend until about Monday and I had a lot of other assignments and work to do that I had to put the project on the backburner for this last week. Rob wanted us to set up Zabbix on the server which was a network monitoring software but due to how old the version of Zabbix was being used, it didn't work with everything else. There was a workaround but I feared for the instability of the server and for now set it aside for Rob or another to do it. I didn't feel comfortable enough to dedicate the time to set it up. There was also some issues with setting up the backup scripts as I previously left the /usr/sbin directory. It turned out that crontab didn't look in that directory for binaries so I shifted it over to /usr/bin and added a log that outputted to /var/log. Admittedly, I didn't have much time this week after losing a third of my work time so a lot of my time was making sure everything was running smoothly and finishing up the documentation.